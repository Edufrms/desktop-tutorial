<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Ejemplo GeoJSON B√©lgica - Comextoolbox</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <style>
    html, body, #map { 
      margin: 0; 
      padding: 0; 
      height: 100%; 
    }
    
    /* Estilos para el tooltip de B√©lgica */
    .belgium-tooltip {
      background: rgba(42, 157, 143, 0.9);
      border: none;
      border-radius: 4px;
      color: white;
      font-size: 0.8rem;
      font-weight: 500;
      padding: 0.3rem 0.6rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .belgium-tooltip::before {
      border-top-color: rgba(42, 157, 143, 0.9);
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // ========================================
    // CONFIGURACI√ìN DE ESTILOS PARA B√âLGICA
    // ========================================
    const BELGIUM_STYLE = {
      // Sin trazo visible para evitar distracciones
      stroke: false,
      // Alternativa: trazo muy sutil si prefieres un contorno
      // stroke: true,
      // color: 'rgba(42, 157, 143, 0.3)',
      // weight: 1,
      
      // Relleno muy ligero con el color corporativo
      fillColor: '#2A9D8F',
      fillOpacity: 0.08,  // Muy transparente para no interferir
      
      // Configuraci√≥n adicional para mejor rendimiento
      clickTolerance: 3,
      smoothFactor: 1
    };

    // ========================================
    // FUNCI√ìN PRINCIPAL DE CARGA DE GEOJSON
    // ========================================
    function loadBelgiumGeoJSON(mapInstance) {
      console.log('üîÑ Cargando GeoJSON de B√©lgica...');
      
      // 1. CARGAR EL ARCHIVO GEOJSON
      fetch('custom.geo.json')
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.json();
        })
        .then(geojson => {
          console.log('‚úÖ GeoJSON cargado exitosamente');
          
          // 2. FILTRAR SOLO B√âLGICA
          const belgiumFeatures = geojson.features.filter(feature => {
            // M√∫ltiples criterios de filtrado para mayor robustez
            const properties = feature.properties || {};
            
            // Criterio 1: Por c√≥digo de pa√≠s
            if (properties.country === 'BEL') return true;
            
            // Criterio 2: Por nombre
            if (properties.name === 'Belgium') return true;
            
            // Criterio 3: Por c√≥digo ISO
            if (properties.ISO_A2 === 'BE') return true;
            if (properties.ISO_A3 === 'BEL') return true;
            
            // Criterio 4: Por nombre administrativo
            if (properties.ADMIN === 'Belgium') return true;
            
            // Si no coincide con ning√∫n criterio, no mostrar
            return false;
          });
          
          console.log(`üéØ Encontradas ${belgiumFeatures.length} features de B√©lgica`);
          
          // 3. CREAR COLECCI√ìN FILTRADA
          const belgiumGeoJSON = {
            type: 'FeatureCollection',
            features: belgiumFeatures
          };
          
          // 4. APLICAR ESTILOS Y A√ëADIR AL MAPA
          if (belgiumFeatures.length > 0) {
            const belgiumLayer = L.geoJSON(belgiumGeoJSON, {
              style: BELGIUM_STYLE,
              
              // Eventos opcionales para interactividad
              onEachFeature: function(feature, layer) {
                // A√±adir tooltip sutil al hacer hover
                layer.bindTooltip('B√©lgica', {
                  permanent: false,
                  direction: 'top',
                  className: 'belgium-tooltip'
                });
                
                // Opcional: hacer clic para informaci√≥n
                layer.on('click', function() {
                  console.log('üó∫Ô∏è Clic en B√©lgica:', feature.properties);
                });
              }
            });
            
            // 5. A√ëADIR LA CAPA AL MAPA
            belgiumLayer.addTo(mapInstance);
            console.log('‚úÖ Silueta de B√©lgica a√±adida al mapa');
            
          } else {
            console.warn('‚ö†Ô∏è No se encontraron features de B√©lgica en el GeoJSON');
          }
        })
        .catch(error => {
          console.error('‚ùå Error cargando GeoJSON de B√©lgica:', error);
          
          // Fallback: mostrar mensaje de error en el mapa
          L.popup()
            .setLatLng([50.85, 4.35])
            .setContent('<strong>Error</strong><br>No se pudo cargar la silueta de B√©lgica')
            .openOn(mapInstance);
        });
    }

    // ========================================
    // INICIALIZACI√ìN DEL MAPA
    // ========================================
    document.addEventListener('DOMContentLoaded', function() {
      // Inicializar mapa centrado en B√©lgica
      const map = L.map('map').setView([50.85, 4.35], 7);
      
      // A√±adir capa de tiles de OpenStreetMap
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      }).addTo(map);
      
      // Cargar B√©lgica con el estilo mejorado
      loadBelgiumGeoJSON(map);
      
      // A√±adir un marcador de ejemplo en Bruselas
      L.marker([50.8503, 4.3517])
        .addTo(map)
        .bindPopup('<strong>Bruselas</strong><br>Capital de B√©lgica')
        .openPopup();
    });
  </script>
</body>
</html> 